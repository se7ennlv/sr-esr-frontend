<div class="p-grid">
    <div class="p-col-12 p-px-0">
        <div class="card">
            <p-toolbar styleClass="p-mb-4 toolbar">
                <ng-template pTemplate="left">
                    <div class="p-mb-1">
                        <p-calendar [inputStyle]="{'border-radius':'0'}" [(ngModel)]="rangeDates" selectionMode="range"
                            dateFormat="yy-mm-dd" [readonlyInput]="true" inputId="range">
                        </p-calendar>
                        <button pButton pRipple type="button" icon="pi pi-search" class="p-button-success rounded-0"
                            (click)="onSearch()">
                        </button>
                    </div>
                </ng-template>
                <ng-template pTemplate="right">
                    <div class="p-fluid">
                        <span class="p-input-icon-left">
                            <i class="pi pi-search"></i>
                            <input pInputText type="text" (input)="dt.filterGlobal($event.target.value, 'contains')"
                                placeholder="Search" />
                        </span>
                    </div>
                    <div class="p-fluid">
                        <button pButton pRipple label="Export" icon="pi pi-upload" class="p-button-help p-ml-2"
                            (click)="exportExcel()">
                        </button>
                    </div>
                </ng-template>
            </p-toolbar>
            <p-table #dt [value]="items" styleClass="p-datatable-sm p-datatable-gridlines" [rowHover]="true" [rows]="10"
                [paginator]="true" [scrollable]="true" [style]="{width:'100%'}" scrollHeight="600px" [filterDelay]="0"
                [globalFilterFields]="['surveyAt','umid','comment']" [showCurrentPageReport]="true"
                currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
                [rowsPerPageOptions]="[10,25,50]">
                <ng-template pTemplate="colgroup">
                    <colgroup>
                        <col style="width:50px">
                        <col style="width:90px">
                        <col style="width:70px">
                        <col style="width:100px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:100px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:100px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:100px">
                        <col style="width:45px">
                        <col style="width:100px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:45px">
                        <col style="width:100px">
                        <col style="width:100px">
                    </colgroup>
                </ng-template>
                <ng-template pTemplate="header">
                    <tr>
                        <th rowspan="2" class="p-text-center">#</th>
                        <th rowspan="2" class="p-text-center">Date</th>
                        <th rowspan="2" class="p-text-center">UMID</th>
                        <th rowspan="2" class="p-text-center">Name</th>
                        <th colspan="3" class="p-text-center">Q1.1</th>
                        <th colspan="3" class="p-text-center">Q1.2</th>
                        <th class="p-text-center">Q1.3</th>
                        <th colspan="2" class="p-text-center">Q1.4</th>
                        <th colspan="3" class="p-text-center">Q1.5</th>
                        <th colspan="3" class="p-text-center">Q1.6</th>
                        <th class="p-text-center">Q1.7</th>
                        <th colspan="3" class="p-text-center">Q2.1</th>
                        <th colspan="3" class="p-text-center">Q2.2</th>
                        <th colspan="3" class="p-text-center">Q2.3</th>
                        <th colspan="3" class="p-text-center">Q2.4</th>
                        <th colspan="3" class="p-text-center">Q2.5</th>
                        <th colspan="3" class="p-text-center">Q2.6</th>
                        <th colspan="3" class="p-text-center">Q2.7</th>
                        <th colspan="8" class="p-text-center">Q2.8</th>
                        <th class="p-text-center">Q2.9</th>
                        <th class="p-text-center">Q3.1</th>
                        <th class="p-text-center">Q3.2</th>
                        <th class="p-text-center">Q3.3</th>
                        <th class="p-text-center">Q3.4</th>
                        <th colspan="4" class="p-text-center">Q3.5</th>
                        <th class="p-text-center">Q4.1</th>
                        <th class="p-text-center">Q4.2</th>
                        <th class="p-text-center">Q4.3</th>
                        <th class="p-text-center">Q4.4</th>
                        <th class="p-text-center">Q4.5</th>
                        <th class="p-text-center">Q5.1</th>
                        <th class="p-text-center">Q5.2</th>
                        <th class="p-text-center">Q5.3</th>
                        <th class="p-text-center">Q5.4</th>
                        <th class="p-text-center">Q5.5</th>
                        <th class="p-text-center">Q5.6</th>
                        <th rowspan="2" class="p-text-center p-text-nowrap p-text-truncate">Comment</th>
                        <th rowspan="2" class="p-text-center p-text-nowrap p-text-truncate">Operates</th>
                    </tr>
                    <tr>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">2</th>
                        <th class="p-text-center">3</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">2</th>
                        <th class="p-text-center">3</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">2</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">2</th>
                        <th class="p-text-center">3</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">2</th>
                        <th class="p-text-center">3</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">2</th>
                        <th class="p-text-center">3</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">2</th>
                        <th class="p-text-center">3</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">2</th>
                        <th class="p-text-center">3</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">2</th>
                        <th class="p-text-center">3</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">2</th>
                        <th class="p-text-center">3</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">2</th>
                        <th class="p-text-center">3</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">2</th>
                        <th class="p-text-center">3</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">2</th>
                        <th class="p-text-center">3</th>
                        <th class="p-text-center">4</th>
                        <th class="p-text-center">5</th>
                        <th class="p-text-center">6</th>
                        <th class="p-text-center">7</th>
                        <th class="p-text-center">8</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">2</th>
                        <th class="p-text-center">3</th>
                        <th class="p-text-center">4</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">1</th>
                        <th class="p-text-center">1</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-item let-rowIndex="rowIndex">
                    <tr>
                        <td class="p-text-center">{{rowIndex + 1}}</td>
                        <td class="p-text-truncate p-text-center">{{item.surveyAt}}</td>
                        <td class="p-text-nowrap p-text-truncate p-text-center">{{item.umid}}</td>
                        <td class="p-text-nowrap p-text-truncate"
                            [tooltipDisabled]="item.fullName?.length < 15 ? true : false" pTooltip="{{item.fullName}}"
                            tooltipPosition="top">{{item.fullName}}
                        </td>
                        <td class="p-text-center">{{item.q111}}</td>
                        <td class="p-text-center">{{item.q112}}</td>
                        <td class="p-text-center">{{item.q113}}</td>
                        <td class="p-text-center">{{item.q121}}</td>
                        <td class="p-text-center">{{item.q122}}</td>
                        <td class="p-text-center">{{item.q123}}</td>
                        <td class="p-text-truncate" [tooltipDisabled]="item.q13?.length < 15 ? true : false"
                            pTooltip="{{item.q13}}" tooltipPosition="top">{{item.q13}}</td>
                        <td class="p-text-center">{{item.q141}}</td>
                        <td class="p-text-center">{{item.q142}}</td>
                        <td class="p-text-center">{{item.q151}}</td>
                        <td class="p-text-center">{{item.q152}}</td>
                        <td class="p-text-center">{{item.q153}}</td>
                        <td class="p-text-center">{{item.q161}}</td>
                        <td class="p-text-center">{{item.q162}}</td>
                        <td class="p-text-center">{{item.q163}}</td>
                        <td class="p-text-center">{{item.q171}}</td>
                        <td class="p-text-center">{{item.q211}}</td>
                        <td class="p-text-center">{{item.q212}}</td>
                        <td class="p-text-center">{{item.q213}}</td>
                        <td class="p-text-center">{{item.q221}}</td>
                        <td class="p-text-center">{{item.q222}}</td>
                        <td class="p-text-center">{{item.q223}}</td>
                        <td class="p-text-center">{{item.q231}}</td>
                        <td class="p-text-center">{{item.q232}}</td>
                        <td class="p-text-center">{{item.q233}}</td>
                        <td class="p-text-center">{{item.q241}}</td>
                        <td class="p-text-center">{{item.q242}}</td>
                        <td class="p-text-center">{{item.q243}}</td>
                        <td class="p-text-center">{{item.q251}}</td>
                        <td class="p-text-center">{{item.q252}}</td>
                        <td class="p-text-center">{{item.q253}}</td>
                        <td class="p-text-center">{{item.q261}}</td>
                        <td class="p-text-center">{{item.q262}}</td>
                        <td class="p-text-center">{{item.q263}}</td>
                        <td class="p-text-center">{{item.q271}}</td>
                        <td class="p-text-center">{{item.q272}}</td>
                        <td class="p-text-center">{{item.q273}}</td>
                        <td class="p-text-center">{{item.q281}}</td>
                        <td class="p-text-center">{{item.q282}}</td>
                        <td class="p-text-center">{{item.q283}}</td>
                        <td class="p-text-center">{{item.q284}}</td>
                        <td class="p-text-center">{{item.q285}}</td>
                        <td class="p-text-center">{{item.q286}}</td>
                        <td class="p-text-center">{{item.q287}}</td>
                        <td class="p-text-center">{{item.q288}}</td>
                        <td class="p-text-truncate" [tooltipDisabled]="item.q29?.length < 20 ? true : false"
                            pTooltip="{{item.q29}}" tooltipPosition="top">{{item.q29}}</td>
                        <td class="p-text-center">{{item.q31}}</td>
                        <td class="p-text-center">{{item.q32}}</td>
                        <td class="p-text-center">{{item.q33}}</td>
                        <td class="p-text-center">{{item.q34}}</td>
                        <td class="p-text-center">{{item.q351}}</td>
                        <td class="p-text-center">{{item.q352}}</td>
                        <td class="p-text-center">{{item.q353}}</td>
                        <td class="p-text-center">{{item.q354}}</td>
                        <td class="p-text-truncate" [tooltipDisabled]="item.q41?.length < 20 ? true : false"
                            pTooltip="{{item.q41}}" tooltipPosition="top">{{item.q41}}
                        </td>
                        <td class="p-text-center">{{item.q42}}</td>
                        <td class="p-text-truncate">{{item.q43}}</td>
                        <td class="p-text-center">{{item.q44}}</td>
                        <td class="p-text-center">{{item.q45}}</td>
                        <td class="p-text-center">{{item.q51}}</td>
                        <td class="p-text-center">{{item.q52}}</td>
                        <td class="p-text-center">{{item.q53}}</td>
                        <td class="p-text-center">{{item.q54}}</td>
                        <td class="p-text-center">{{item.q55}}</td>
                        <td class="p-text-center">{{item.q56}}</td>
                        <td class="p-text-truncate" [tooltipDisabled]="item.comment?.length < 20 ? true : false"
                            pTooltip="{{item.comment}}" tooltipPosition="top">{{item.comment}}
                        </td>
                        <td class="p-text-center p-text-truncate">
                            <button pButton pRipple icon="pi pi-pencil" class="p-button-rounded p-button-success p-mr-2"
                                (click)="onUpdate(item)">
                            </button>
                            <button *ngIf="!item.is_default" pButton pRipple icon="pi pi-trash"
                                class="p-button-rounded p-button-warning" (click)="onDelete(item._id)">
                            </button>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </div>
</div>

<app-sro-form *ngIf="includeForm"></app-sro-form>

<p-toast></p-toast>
<p-confirmDialog [style]="{width: '450px'}"></p-confirmDialog>